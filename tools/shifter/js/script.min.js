!function(){"use strict";const e=document.querySelector("#main"),t=document.querySelector("#add"),n=document.querySelector("#export"),r=document.querySelector("#number");function o(e){e.stopPropagation(),e.preventDefault(),e.currentTarget.classList.toggle("selected")}let l=0;const c=()=>{const e=i("#text")[0];return l+=Number(e),l%e==0?1:0},i=e=>document.querySelector(e).value,a=e=>{const t=document.getElementById(e);return 0===t.children.length&&""===t.textContent.trim()},d=function(){this.parentElement.remove(),r.disabled=!a("table")};function s(e){return e.stopPropagation(),e.preventDefault(),e.currentTarget.innerText=i("#text"),e.currentTarget.innerText}const m=(e,t)=>{const n=document.createElement(e);return n.innerHTML=t,n},u=function(e){const[,...t]=e.parentElement.children;return t.length-=3,t},h=function(){const e=u(this);if(e.length<2)return;const t=e[e.length-1].innerText;for(let t=e.length-1;t>0;t--)e[t].innerText=e[t-1].innerText;e[0].innerText=t},x=function(){const e=u(this);if(e.length<2)return;const t=e[0].innerText;for(let t=0;t<e.length-1;t++)e[t].innerText=e[t+1].innerText;e[e.length-1].innerText=t},p=(t,n)=>{let r;e.children.length>0?r=document.getElementsByTagName("table")[0]:(r=document.createElement("table"),r.id="table",r.setAttribute("cellpadding","0"),r.setAttribute("cellspacing","0"),r.style.gridTemplateColumns=`repeat(${Number(t)+4}, minmax(20px, 1fr))`);const l=document.createDocumentFragment(),a=m("tr","");l.appendChild(a);const u=m("td",(p=n)?p.charAt(0).toUpperCase()+p.slice(1):"");var p;u.addEventListener("dblclick",(e=>s.call(u,e))),a.appendChild(u);const g=Number(t)>=28&&Number(t)<=31?Number(t):31;for(let e=1;e<=g;e++){let t=e<10?`0${e}`:e;const n=i("#text");n.indexOf("+")>0?t=c():n.length>0&&(t=n);const r=m("td",t);r.align="center",0===e&&(r.className="Name"),r.onclick=o,r.ondblclick=s,a.appendChild(r)}const b=m("td","remove"),f=m("td","<"),k=m("td",">");b.id="remove",f.id="left",k.id="right",b.onclick=e=>d.call(b,e),f.onclick=e=>x.call(f,e),k.onclick=e=>h.call(k,e),a.appendChild(b),a.appendChild(f),a.appendChild(k),r.appendChild(l),e.appendChild(r)},g=(e,t)=>{e.nodeType||(e=document.getElementById(e)),(e=>{Array.from(e.rows).forEach((e=>{Array.from(e.cells).forEach((e=>{const t=getComputedStyle(e);if("remove"!==e.textContent.toLowerCase()&&"<"!==e.textContent&&">"!==e.textContent||e.remove(),t.backgroundColor&&"rgba(0, 0, 0, 0)"!==t.backgroundColor&&e.setAttribute("bgcolor","#eee"),t.width&&"auto"!==t.width&&"0px"!==t.width){const n=parseInt(t.width,10);isNaN(n)||(e.setAttribute("width",n),e.style.width=n+"px")}}))}))})(e);const n={worksheet:t||"Worksheet",table:e.cloneNode(!0).innerHTML};var r;window.location.href="data:application/vnd.ms-excel;base64,"+(e=>{const t=(new TextEncoder).encode(e);let n="";return t.forEach((e=>n+=String.fromCharCode(e))),window.btoa(n)})((r=n,'\n    <html xmlns:o="urn:schemas-microsoft-com:office:office"\n    xmlns:x="urn:schemas-microsoft-com:office:excel"\n    xmlns="http://www.w3.org/TR/REC-html40">\n    <head>\n    \x3c!--[if gte mso 9]>\n    <xml>\n    <x:ExcelWorkbook>\n    <x:ExcelWorksheets>\n    <x:ExcelWorksheet>\n    <x:Name>{worksheet}</x:Name>\n    <x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions>\n    </x:ExcelWorksheet>\n    </x:ExcelWorksheets>\n    </x:ExcelWorkbook>\n    </xml>\n    <![endif]--\x3e\n    <meta http-equiv="content-type" content="text/plain; charset=UTF-8"/>\n    </head>\n    <body>\n    <table>{table}</table>\n    </body>\n    </html>'.replace(/{(\w+)}/g,((e,t)=>r[t]))))};document.getElementById("add-text-to-selected").addEventListener("click",(()=>{e.querySelectorAll(".selected").forEach((e=>{e.innerText=i("#text")}))})),n.addEventListener("click",(()=>g("table"))),t.addEventListener("click",(()=>{a("table")?p(i("#number"),f):p(i("#number"),i("#name")),r.disabled=!0}));const b=new Date,f=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}-${String(b.getDate()).padStart(2,"0")}`;""===e.innerHTML.trim()&&(p(i("#number"),f),r.disabled=!0)}();
